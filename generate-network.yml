---
- name: Fabric building
  hosts: all
  become: true

  tasks:

    - include_tasks: tasks/configuring_interfaces.yml

#    - include_tasks: tasks/5549/adding_servers_interfaces.yml
#      when: option == '5549'

    - include_tasks: tasks/install_frr_servers.yml
      when: "'servers' in group_names"

    - name: Activating bgp + zebra daemons
      template: 
        src: templates/daemons
        dest: /etc/frr/daemons

    - name: Adding BGP config 
      template: 
        src: templates/bgp.j2
        dest: /etc/frr/frr.conf

    - name: Restart frr service
      service: 
        name: frr
        state: restarted